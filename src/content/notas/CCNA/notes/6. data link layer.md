prepara los datos de la red paa la red fisica. Es responsable de la network interface card (NIC) para su comunicacion con la red.
- permite a las capas superiores acceder a los medios. El protocolo de la capa superior no tiene idea del tipo de medio que se usa para reenviar los datos
- acepta datos, usualmente paquetes IPv4 o IPv6, y los encapsula en frames de layer 2(osi)
- controla como los datos son asignados y recibidos en el medio
- intercambia frames entre endpoints a traves de la red
- recibe datos encapsulados, usualmente packetes IPv4 o IPv6, y los redirige hacia el protocolo de capa superior adecuado
- deteccion de errores y rechaza frames corruptos
sin el data link layer, a los protocolos de capa de red como IP les seria dificil conectar a todos los tipos de medios que puedan existing en el camino de delivery. 
el Data Link layer agrega **ethernet destination** y **informacion NIC** al paquete de capa 3.

## subcapas IEEE 802.2 LAN/MAN data link
el data link layer IEEE 802 LAN/MAN consiste de 2 subcapas
- *logical link control* (LLC) - esta subcapa de IEEE 802.2 se comunica entre el software de red **con las capas superiores** y el hardware del dispositivo en las capas inferiores. Pone la informacion en frames que identifican que protocolo de network layer (IPv4, IPv6) se esta utilizando para el frame.
- *media access control* (MAC): implementan esta subcapa (IEEE 802.3, 802.11 o 802.15) en hardware. Controla el NIC(y algun otro hardware responsable para mandar y recibir datos en medio LAN/MAN) y es responsable de la **encapsulacion de datos** y media access control. Provee direccionamiento de capa data link y esta integrada con varias tecnologias de la capa fisica.
	- encapsulacion de datos:
		- delimitacion de frame. Para identificar campos de un frame, estos bits delimitadores proveen sincronizacion entre el transmisor y los nodos receptores.
		- direccionamiento: provee direccionamiento de emisor y destinatario para transportar el frame dde capa 2 a traves de un mismo medio compartido.
		- deteccion de errores: incluye trailer para detectar errores de transmision.
![[Pasted image 20260202195650.png]]

## dandole acceso al medio
cada red tiene caracteristicas distintas y la capa 2 se adapta a cada tipo de medio. Por ejemplo, un ethernet LAN usualmente consiste de muchos host peleando por acceso el medio de red, esto *lo resuelve la subcapa MAC*. Con links seriales el metodo de acceso podria solo consistir de una conexion directa entre solo 2 dispositivos, usualmente 2 routers. Entonces no necesitarian las tecnicas empleadas por el IEEE 802 MAC sublayer.

el route encapsula el paquete en el tipo de frame apropiado, se utiliza el metodo de media access control (MAC) adecuado para acceder a cada link. En un intercambio de paquetes de capa de red, pueden haber muchos data link layers y transiciones de medio.

en cada salto en el camino, el router tiene estas funciones:
1. acepta el frame que viene de un medio
2. de-encapsula el frame
3. re-encapsula el paquete en un nuevo frame
4. redirecciona el nuevo frame apropiado al medio de ese segmento de la red fisica

LAN suele usar ethernet
WAN suele usar serial, ethernet, u otras tecnologias.
el route re-encapsula siempre, no importa si es LAN o WAN
![[Pasted image 20260203132738.png]]
![[Pasted image 20260203132749.png]]
![[Pasted image 20260203132804.png]]
![[Pasted image 20260203132816.png]]

## data link layer standards
organizaciones de ingenieria que definen standares abiertos y protocoles que aplican para el network layer

- IEEE institute of electrical and electronics engineers
- ITU international telecommunication union
- ISO international organization for standarization
- ANSI american national standards institute

OSI                  TCP/IP
Layer 3  ─┐
Layer 2  ─┼─> Network Access Layer
Layer 1  ─┘

# topologias
La topología de una red es la disposición o la relación entre los dispositivos de red y las interconexiones entre ellos.

hay 2 tipos de topologias utilizadas al describir redes LAN o WAN:
- topologia fisica - identifica las conexiones fisicas y como los end devices e intermediary devices son interconectados. Esta topologia tambien puede llegar a incluir locacion especifica del dispositivo como en la oficina donde esta situado o la direccion. **Son usualmente point-to-point (P2P) o estrella**
- topologia logica - *refiere a la manera que la red transfiere frames de un nodo a otro*. Identifica conexiones virtuales usando interfaces de dispositivos y esquemas de direccionamiento IP

topologia fisica:
![[Pasted image 20260203152355.png]]
topologia logica:
![[Pasted image 20260203152349.png]]

### topologias WAN
#### P2P point to point
consiste de un link permanente entre 2 endpoints
![[Pasted image 20260203153512.png]]

#### hub and spoke
es la version WAN de la topologia "star" en la cual un dispositivo central interconecta ramas a traves de puntos P2P. Las ramas no pueden intercambiar datos con otras ramas sin pasar por el punto central.
![[Pasted image 20260203153629.png]]

#### mesh
esta topología proporciona alta disponibilidad, pero requiere que todos los sistemas finales estén interconectados entre sí. Por lo tanto, los costes administrativos y físicos pueden ser significativos. Cada enlace es esencialmente un enlace P2P con el otro nodo. 
![[Pasted image 20260203153747.png]]

pueden haber variaciones hibridas de topologias, por ejemplo partial mesh: donde algunos, no todos, los dispositivos estan interconectados.

### topologia P2P WAN
un nodo pone los frames en el medio en un extremo de la red y esos frames son tomados por el medio del otro nodo al extremo del circuito P2P. Esta limitado a 2 nodos unicamente.
**NO SE NECESITA DIRECCION MAC EN P2P WAN**, no es necesario aclarar el medio con otros host.
Ademas, cuando un nodo recibe en frame, no debe determinar si ese frame esta destinado al mismo nodo o a otro nodo.
![[Pasted image 20260203154116.png]]

Cuando se utiliza **ethernet si es necesario determinar si el frame entrante es destinado al nodo actual**

el emisor y recepsor pueden estar conectados indirectamente, usando dispositivos intermedios pero esto no afecta la topologia logica. El la conexion logica de P2P es la misma.
![[Pasted image 20260203154625.png]]

### topologias LAN
en LAN multiacceso, los end devices (como los nodos por ejemplo) estan interconectados usando topologias de star o extended start. En estos tipos de topologias, los end devices estan conectados a un dispositivo intermediario central.

la topologia extended star extiende esat topologia al interconectar multiples switches ethernet. Las topologias start y extended star son faciles de instalar, bastante escalables (facil de anadir y remover end devices) y facil de hacer troubleshooting. Antes, estas topologias start eran interconectadas usando ethernet *hubs*

## topologias LAN legacy
el ethernet prematuro y los primeros tecnologias Token Ring LAN incluian otros 2 tipos de topologias:
- bus - todos los end systems estaban encadenados entre si y terminados en una forma en los extremos. Dispositivos de infrastructura, como los switches, no requieren que esten interconectados a end devices. Redes legacy ethernet usualmente eran topologias bus que usaban cable coaxil porque era barato y facil de instalar
- ring - end systems son conectados a su respectivo vecino formando un anillo. El anillo no tiene por que estar terminado, a diferencia de la topologia bus. Legacy fiber distributed data interface (FDDI) y redes token ring usaban topologias ring.
![[Pasted image 20260203161848.png]]

## comunicacion half and full-duplex
- #### half-duplex:
	ambos dispositivos pueden transmitir y recibir en el medio pero no pueden hacerlo simultaneamente. WLAN's y topologias bus legacy con hubs ethernet usan el modo half-duplex.  
- #### full-duplex
	los 2 dispositivos pueden transmitir y recibir simultaneamente en el medio compartido. El data link layer asume que el medio esta disponible para transmision en los dos nodos en cualquier momento. Los **switches ethernet operan en modo full-duplex por default"**, pero tambien pueden operar en half-duplex si se conectan a un dispositivo como un ethernet hub

# metodos de control de acceso
LAN ethernet y WLAN's son ejemplos de redes multiacceso. Una red multiacceso es una red que puede tener 2 o mas end devices intentando acceder a la red simultaneamente. 

Algunas redes multiacceso necesitan reglas para decidir como los dispositivos comparten el medio fisico. Hay 2 metodos para control de acceso basico para el medio compartido:
- Contention-based Access: todos los nodos operan como half-duplex y compiten por el uso del medio compartido. Solamente un dispositivo puede transmitir al mismo tiempo: ejemplos de contention-based methods:
	- carrier sense multiple access with collision detection ([[CSMA-CD]]) usados el legacy bus-topology ethernet LANs
	- carrier sense multiple access with collision avoidance ([[CSMA-CA]]) usado en WLANs 
# acceso controlado
en una red con controlled-based multiaccess, cada nodo tiene su tiempo para usar el medio. estos tipos de redes legacy deterministicas son ineficientes porque un dispositivo debe esperar su turno para acceder al medio. Ejemplos de redes multiacceso que usan acceso controlado incluyen:
- legacy token ring
- legacy ARCNET
![[Pasted image 20260203170259.png]]
cada nodo espera por su turno para acceder al medio de red
nota: actualmente, redes network funcionan con full-duplex y no requieren metodo de acceso

# contention-based access
ejemplos de contention-based access networks:
 - wlan ([[CSMA-CA]])
 - legacy bus-topology ethernet LAN ([[CSMA-CD]])
 - legacy ethernet using a hub ([[CSMA-CD]])
 existe el tipo [[CSMA-CA]] (contention-based access networks **collision avoidance**) y [[CSMA-CD]](contention-based access network **collition detection**)
## [[CSMA-CD]]
operan en modo half-duplex, solo un dispositivo puede mandar o recibir en una porcion de tiempo.
Si dos dispositivos transmiten al mismo tiempo, va a ocurrir una cosiion. Para legacy ethernet LANs, ambos dispositivos van a detectar la colision en la red. El NIC compara datos transmitidos con datos recibidos or reconocen que la amplitud de la senal es mas grande que la normal en el medio. Los datos enviados por **ambos dispositivos** sera corrupta y deberan reenviarla

ejemplo: una pc debe transmitir un frame, esta pc debera determinar si algun dispositivo esta transmitiendo en el medio, si no detecta ninguna senal se asume que la red esta disponible para emitir.

> ethernet hub: tambien conocido como repetidor multipuerto, los bits recibidos por un puertos seran regenerados y enviados en todos los otros puertos, menos en el que lo recibio.

aunque un ethernet hub envie frames ethernet por todos sus puertos, solo el dispositivo que sea el destinatario aceptara y copiara el frame entero, todos los otros NICs ignoraran el frame.

## [[CSMA-CA]]
es otra forma de CSMA usada por IEEE 802.11 WLANs con la diferencia de las siglas "collision avoidance". El metodo para detectar si el medio esta disponible es similar a [[CSMA-CD]]. [[CSMA-CA]] utiliza tecnicas adicionales, en entornos wireless puede no ser posible para un dispositivo detectar una colision. Esta tecnica no detecta colisiones pero *intenta evitarlas esperando antes de transmitir*. Cada dispositivo que transmite incluye la duracion que necesita para la transmision. Todos los otros dispositivos wireless reciben esta informacion y saben por cuanto tiempo el medio no sera disponible.
![[Pasted image 20260203184617.png]]
si el host A esta recibiendo un frame desde el access point, los hosts B y C tambien veran el frame y sabran por cuanto tiempo el medio no sera disponible. Luego de que el receptor reciba el frame 802.11, el receptor enviara un acknowledgment para que el emisor sepa que el frame llego correctamente.

Contention-based systems no escalan bien bajo un uso pesado del medio.

nota: LANs ethernet usando switches no usan contention-based system porque el NIC del switch y el NIC del host operan en full-duplex

# data link frame
la capa data link prepara los datos encapsulados (usualmente paquete IPv4 o IPv6) para transportar a traves del medio local encapsulandolo con un header y un trailer, creando asi un frame

el data link protocol es responsable de comunicaciones NIC-to-NIC dentro de la misma red. Aunque haya muchos protocolos data link diferentes que describan frames, cada frame tiene 3 partes basicas:
- header
- datos 
- trailer (al final del frame)

**todos los protocolos de capa data link encapsulan los datos dentro del mismo campo del frame**, pero la estructura del frame y los campos en el header y trailer pueden variar de acuerdo al protocolo.

no hay una unica estrucutra que satisfaga todas las necesidades para transportar datos en cualquier tipo de medio. Dependiendo del medio, la cantidad de informacion de control upede variar de acuerdo a los requerimientos del medio y de la topologia logica.

![[Pasted image 20260203190213.png]]
en este ejemplo se necesitara mas esfuerzo para mandar frames, resultara en mayor overhead y menos velocidad de transmision

## campos del frame
Abajo esta la imagen de un frame generico, no todos los protocolos incluyen todos los campos. Los estandares para un protocolo de data link especifico definen el formato actual del frame.
![[Pasted image 20260203190400.png]]
- Frame start and stop indicator flags - Used to identify the beginning and end limits of the frame.
- Addressing - Indicates the source and destination nodes on the media.
- Type - Identifies the Layer 3 protocol in the data field.
- Control - Identifies special flow control services such as quality of service (QoS). QoS gives forwarding priority to certain types of messages. For example, voice over IP (VoIP) frames normally receive priority because they are sensitive to delay.
- Data - Contains the frame payload (i.e., packet header, segment header, and the data).
- Error Detection - Included after the data to form the trailer.

la deteccion de error en el anteultimo campo determina si el frame llego sin errores. Pone un resumen matematico de los bits que componen al frame, los nodos que los transmitan crearan resumenes de los contenidos del frame con (CRC) y se colocaran en el frame check sequence (FCS) para representar los contenidos de este. 

# direcciones de capa 2
la direcciones de data link estan dentro del frame header y especifica el nodo destino del frame en la red local, esta tipicamente al inicio del frame asi el NIC puede determinar si su propia direccion de capa 2 coincide con la del frame antes de aceptar el resto del frame. El header tambien podria contener la direccion del emisor.

Estas direcciones no indican en que red el dispositivo esta localizado, el dispositivo seguira usando la misma direccion aunque se mueva de red o subred.

## host-to-router 
el emisor encapsula el packete IP de capa 3 en un frame de capa 2. En el header, anade su direccion de capa 2 como el origen y la direccion de capa 2 del router como destino
![[Pasted image 20260203192906.png]]

## router-to-router
el router desencapsula el paquete IP de capa 3 en un nuevo frame de capa 2. En el header del frame, **el router anade su propia direccion de capa 2 como origen y tambien anade la direccion de capa 2 del proximo router como destino** 
![[Pasted image 20260203193101.png]]

## router-to-host
el router 2 encapsula el paquete IP de capa 3 en un nuevo frame de capa 2. En el header del frame, **R2 anade su direccion de capa 2 como el origen y la direccion de capa 2 del server como destino**
![[Pasted image 20260203193653.png]]

# frames LAN y WAN
los protocolos ethernet son usados por LANs cableadas, las comunicaciones innalambrican tambien caen dentro de los protocolos WLAN. Estos protocolos fueron disenados para redes multiacceso

tradicionalmente los WANs usan otros tipos de protocolos para diferentes tipos de topologias P2P, hub-spoke y full-mesh. Algunos protocolos WAN comunes:
- Point-to-Point Protocol (PPP)
- High-Level Data Link Control (HDLC)
- Frame Relay
- Asynchronous Transfer Mode (ATM)
- X.25

hoy en dia, estos protocolos mencionados anteriormente estan siendo reemplazados por ethernet.
En una red TCP/IP, todos los protocolos de capa 3 IP funcionan en OSI capa 2. El protocolo de capa 2 que se use depende de la topologia logica y el medio fisico.

el protocolo que se use de capa 2 para una red particular es determinado por la tecnologia usada para implementar esa topologia

la diferencia de bandwith generalmente resulta en el uso de diferentes protocoloes para LANs y WANs 

LAN -> high bandwidth
WAN -> low bandwidth

# preguntas
What does a router do after de-encapsulating a received frame?  
forwards the new frame onto the network medium  
de-encapsulates the frame  
re-encapsulates the packet into a new frame  
**determines the best path**