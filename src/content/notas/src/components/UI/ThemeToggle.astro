---
---

<button 
	id="theme-toggle" 
	aria-label="Toggle theme"
	class="theme-toggle"
>
	<svg class="icon-light" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
		<circle cx="12" cy="12" r="4"></circle>
		<path d="m12 2v2"></path>
		<path d="m12 20v2"></path>
		<path d="m4.93 4.93 1.41 1.41"></path>
		<path d="m17.66 17.66 1.41 1.41"></path>
		<path d="m2 12h2"></path>
		<path d="m20 12h2"></path>
		<path d="m6.34 17.66-1.41 1.41"></path>
		<path d="m19.07 4.93-1.41 1.41"></path>
	</svg>
	<svg class="icon-dark" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
		<path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
	</svg>
	<svg class="icon-system" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" width="20" height="20">
		<rect width="20" height="14" x="2" y="3" rx="2"></rect>
		<line x1="8" x2="16" y1="21" y2="21"></line>
		<line x1="12" x2="12" y1="17" y2="21"></line>
	</svg>
</button>

<script>
	(function() {
		function getTheme() {
			if (localStorage.theme === 'dark') return 'dark';
			if (localStorage.theme === 'light') return 'light';
			return 'system';
		}

		function applyTheme(theme) {
			const root = document.documentElement;
			
			if (theme === 'system') {
				const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
				root.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
			} else {
				root.setAttribute('data-theme', theme);
			}
		}

		function updateIcon() {
			const button = document.getElementById('theme-toggle');
			if (!button) return;
			
			const theme = getTheme();
			const iconLight = button.querySelector('.icon-light');
			const iconDark = button.querySelector('.icon-dark');
			const iconSystem = button.querySelector('.icon-system');
			
			// Hide all icons
			if (iconLight) iconLight.style.display = 'none';
			if (iconDark) iconDark.style.display = 'none';
			if (iconSystem) iconSystem.style.display = 'none';
			
			// Show appropriate icon
			if (theme === 'system' && iconSystem) {
				iconSystem.style.display = 'block';
			} else if (theme === 'dark' && iconDark) {
				iconDark.style.display = 'block';
			} else if (iconLight) {
				iconLight.style.display = 'block';
			}
		}

		function cycleTheme() {
			const current = getTheme();
			let next;
			
			if (current === 'system') {
				next = 'light';
			} else if (current === 'light') {
				next = 'dark';
			} else {
				next = 'system';
			}
			
			if (next === 'system') {
				localStorage.removeItem('theme');
			} else {
				localStorage.theme = next;
			}
			
			applyTheme(next);
			updateIcon();
		}

		// Initialize on load
		applyTheme(getTheme());
		updateIcon();

		// Listen for system theme changes when in system mode
		window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', (e) => {
			if (getTheme() === 'system') {
				applyTheme('system');
			}
		});

		// Set up toggle button
		const button = document.getElementById('theme-toggle');
		if (button) {
			button.addEventListener('click', cycleTheme);
		}
	})();
</script>

<style>
	.theme-toggle {
		background: none;
		border: none;
		cursor: pointer;
		padding: 0.5em;
		border-radius: 4px;
		display: flex;
		align-items: center;
		justify-content: center;
		color: rgb(var(--text-secondary));
		transition: color 0.2s, background-color 0.2s;
	}

	.theme-toggle:hover {
		background-color: rgb(var(--bg-secondary));
		color: rgb(var(--text-primary));
	}

	:global([data-theme='dark']) .theme-toggle {
		color: rgb(var(--text-secondary));
	}

	:global([data-theme='dark']) .theme-toggle:hover {
		background-color: rgb(var(--bg-secondary));
		color: rgb(var(--text-primary));
	}

	.theme-toggle svg {
		display: none;
	}
</style>
